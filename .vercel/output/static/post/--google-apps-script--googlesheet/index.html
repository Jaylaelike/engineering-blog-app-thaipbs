<!DOCTYPE html><html lang="th" class="scroll-smooth" data-astro-cid-37fxchfa> <head><meta name="sentry-trace" content="81f6954efac66b818fa569e9ccac8b73-9d41d853bba0e96f-1"/>
<meta name="baggage" content="sentry-environment=production,sentry-release=2803151fc4ca66b9ba03b62f4656e0a6f2bbf8b5,sentry-public_key=de101131b80407eb6654bc9323d17eed,sentry-trace_id=81f6954efac66b818fa569e9ccac8b73,sentry-sample_rate=1,sentry-transaction=GET%20%2Fpost%2F%5Bslug%5D%2F,sentry-sampled=true"/><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.16.6"><!-- Canonical URL --><link rel="canonical" href="https://engineering-blog-thaipbs.vercel.app/post/--google-apps-script--googlesheet/"><!-- Primary Meta Tags --><title>การสร้างผู้ช่วยแจ้งเตือนวันที่หมดสัญญาลูกค้า โดยใช้ Google Apps Script • Astro Theme OpenBlog</title><!-- ViewTransitions  --><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><!-- SEO --><meta name="title" content="การสร้างผู้ช่วยแจ้งเตือนวันที่หมดสัญญาลูกค้า โดยใช้ Google Apps Script • Astro Theme OpenBlog"><meta name="description" content="การสร้างผู้ช่วยแจ้งเตือนวันที่หมดสัญญาลูกค้า โดยใช้ Google Apps Script"><meta name="author" content="DanielCG"><!-- Open Graph / Facebook --><meta property="og:type" content="article"><meta property="og:url" content="https://engineering-blog-thaipbs.vercel.app/post/--google-apps-script--googlesheet/"><meta property="og:title" content="การสร้างผู้ช่วยแจ้งเตือนวันที่หมดสัญญาลูกค้า โดยใช้ Google Apps Script"><meta property="og:description" content="การสร้างผู้ช่วยแจ้งเตือนวันที่หมดสัญญาลูกค้า โดยใช้ Google Apps Script"><meta property="og:image" content="https://engineering-blog-thaipbs.vercel.app/_astro/Gs_gas.BYGlhtKw.png"><meta property="article:author" content="DanielCG"><meta property="article:published_time" content="2024-05-23T17:00:00.000Z"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://engineering-blog-thaipbs.vercel.app/post/--google-apps-script--googlesheet/"><meta property="twitter:title" content="การสร้างผู้ช่วยแจ้งเตือนวันที่หมดสัญญาลูกค้า โดยใช้ Google Apps Script"><meta property="twitter:description" content="การสร้างผู้ช่วยแจ้งเตือนวันที่หมดสัญญาลูกค้า โดยใช้ Google Apps Script"><meta property="twitter:image" content="https://engineering-blog-thaipbs.vercel.app/_astro/Gs_gas.BYGlhtKw.png"><!-- RSS auto-discovery --><link rel="alternate" type="application/rss+xml" title="Astro Theme OpenBlog" href="/rss.xml"><link as="font" crossorigin rel="preload" href="/fonts/Manrope-Bold.woff2" type="font/woff2"><style>@font-face {font-weight: 200;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-ExtraLight.woff2)}</style><style>@font-face {font-weight: 300;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-Light.woff2)}</style><style>@font-face {font-weight: 400;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-Regular.woff2)}</style><style>@font-face {font-weight: 500;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-Medium.woff2)}</style><style>@font-face {font-weight: 600;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-SemiBold.woff2)}</style><style>@font-face {font-weight: 700;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-Bold.woff2)}</style><style>@font-face {font-weight: 800;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-ExtraBold.woff2)}</style><style>@font-face { font-family: _font_fallback_1729570546500; size-adjust: 103.76%; src: local('Arial'); ascent-override: 102.74%; descent-override: 28.91%; line-gap-override: 0.00%; }</style><script>
  function getTheme() {
    const storedTheme =
      typeof localStorage !== "undefined" && localStorage.getItem("theme");

    return (
      storedTheme ||
      (window.matchMedia("(prefers-color-scheme: light)").matches
        ? "light"
        : "dark")
    );
  }

  function setTheme(newTheme) {
    const html = document.documentElement;
    const isDark = newTheme === "dark";

    html.classList.toggle("dark", isDark);
    html.classList.toggle("light", !isDark);

    localStorage.setItem("theme", newTheme);
  }

  // set initial theme
  setTheme(getTheme());
  document.addEventListener("astro:after-swap", () => setTheme(getTheme()));

  document.addEventListener("theme-change", (e) => {
    setTheme(e.detail.theme);
  });
</script><script>
  if (!("animations" in localStorage)) {
    localStorage.setItem("animations", "true");
  } else {
    localStorage.setItem("animations", "false");
  }
</script><link rel="stylesheet" href="/_astro/_page_.zUMWEWrJ.css">
<link rel="stylesheet" href="/_astro/_slug_.D5OVbu1o.css"><script type="module" src="/_astro/hoisted.7hro7AMN.js"></script>
<script type="module" src="/_astro/page.CvRsTxPz.js"></script>
<script>window.va = window.va || function () { (window.vaq = window.vaq || []).push(arguments); };
		var script = document.createElement('script');
		script.defer = true;
		script.src = '/_vercel/insights/script.js';
		var head = document.querySelector('head');
		head.appendChild(script);
	</script><style>.link-preview[data-astro-cid-hkusvy5r]{--lp-width: var(--link-preview-width, 30em);--lp-pad-x: var(--link-preview-padding-inline, 0);--lp-pad-y: var(--link-preview-padding-block, .5em);--lp-corners: var(--link-preview-corners, 0);--lp-desc-lines: var(--link-preview-description-lines, 1);position:relative;width:var(--lp-width);max-width:100%;display:flex;flex-direction:column-reverse;border-radius:var(--lp-corners)}.link-preview[data-astro-cid-hkusvy5r] [data-astro-cid-hkusvy5r]{margin:0!important}.link-preview__content[data-astro-cid-hkusvy5r]{display:flex;flex-direction:column;padding:var(--lp-pad-y) var(--lp-pad-x)}.link-preview[data-astro-cid-hkusvy5r] header[data-astro-cid-hkusvy5r]{display:flex;flex-direction:column-reverse}.link-preview__description[data-astro-cid-hkusvy5r]{display:-webkit-box;-webkit-line-clamp:var(--lp-desc-lines);-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis}.link-preview[data-astro-cid-hkusvy5r]:not(.link-preview--has-video) a[data-astro-cid-hkusvy5r]:after{content:"";position:absolute;inset:0}.link-preview[data-astro-cid-hkusvy5r] img[data-astro-cid-hkusvy5r],.link-preview[data-astro-cid-hkusvy5r] video[data-astro-cid-hkusvy5r]{aspect-ratio:1200 / 630;width:100%;height:auto;-o-object-fit:cover;object-fit:cover;border-top-left-radius:var(--lp-corners);border-top-right-radius:var(--lp-corners)}
</style><style>.twitter-tweet:not(.twitter-tweet-rendered){padding:var(--tc-padding, 1em);border:1px solid var(--tc-border-color, #cfd9de)}.twitter-tweet:not(.twitter-tweet-rendered)>:first-child{margin-top:0}.twitter-tweet:not(.twitter-tweet-rendered)>:last-child{margin-bottom:0}
</style><style>lite-vimeo{font-size:10px;background-color:#000;position:relative;display:block;contain:content;background-position:center center;background-size:cover}lite-vimeo:after{content:"";display:block;padding-bottom:56.25%}lite-vimeo>iframe{all:unset!important;width:100%!important;height:100%!important;position:absolute!important;inset:0!important;border:0!important}lite-vimeo>.ltv-playbtn{content:"";position:absolute;inset:0;width:100%;background:transparent;outline:0;border:0;cursor:pointer}lite-vimeo>.ltv-playbtn:before{width:6.5em;height:4em;background:#172322bf;opacity:.8;border-radius:.25rem;transition:all .2s cubic-bezier(0,0,.2,1)}lite-vimeo>.ltv-playbtn:focus:before{outline:auto}lite-vimeo:hover>.ltv-playbtn:before{background-color:#00adef;background-color:var(--ltv-color, #00adef);opacity:1}lite-vimeo>.ltv-playbtn:after{border-style:solid;border-width:1em 0 1em 1.7em;border-color:transparent transparent transparent #fff}lite-vimeo>.ltv-playbtn:before,lite-vimeo>.ltv-playbtn:after{content:"";position:absolute;top:50%;left:50%;transform:translate3d(-50%,-50%,0)}lite-vimeo.ltv-activated:before,lite-vimeo.ltv-activated>.ltv-playbtn{cursor:unset;opacity:0;pointer-events:none}
</style><style>lite-youtube>iframe{all:unset!important;width:100%!important;height:100%!important;position:absolute!important;inset:0!important;border:0!important}
</style><style>lite-youtube{background-color:#000;position:relative;display:block;contain:content;background-position:center center;background-size:cover;cursor:pointer;max-width:720px}lite-youtube:before{content:attr(data-title);display:block;position:absolute;top:0;background-image:linear-gradient(180deg,#000000ab,#0000008a 14%,#00000026 54%,#0000000d 72%,#0000 94%);height:99px;width:100%;font-family:YouTube Noto,Roboto,Arial,Helvetica,sans-serif;color:#eee;text-shadow:0 0 2px rgba(0,0,0,.5);font-size:18px;padding:25px 20px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;box-sizing:border-box}lite-youtube:hover:before{color:#fff}lite-youtube:after{content:"";display:block;padding-bottom:56.25%}lite-youtube>iframe{width:100%;height:100%;position:absolute;top:0;left:0;border:0}lite-youtube>.lty-playbtn{display:block;width:100%;height:100%;background:no-repeat center/68px 48px;background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 68 48"><path d="M66.52 7.74c-.78-2.93-2.49-5.41-5.42-6.19C55.79.13 34 0 34 0S12.21.13 6.9 1.55c-2.93.78-4.63 3.26-5.42 6.19C.06 13.05 0 24 0 24s.06 10.95 1.48 16.26c.78 2.93 2.49 5.41 5.42 6.19C12.21 47.87 34 48 34 48s21.79-.13 27.1-1.55c2.93-.78 4.64-3.26 5.42-6.19C67.94 34.95 68 24 68 24s-.06-10.95-1.48-16.26z" fill="red"/><path d="M45 24 27 14v20" fill="white"/></svg>');position:absolute;cursor:pointer;z-index:1;filter:grayscale(100%);transition:filter .1s cubic-bezier(0,0,.2,1);border:0}lite-youtube:hover>.lty-playbtn,lite-youtube .lty-playbtn:focus{filter:none}lite-youtube.lyt-activated{cursor:unset}lite-youtube.lyt-activated:before,lite-youtube.lyt-activated>.lty-playbtn{opacity:0;pointer-events:none}.lyt-visually-hidden{clip:rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}
</style><script src="/_astro/YouTube.astro_astro_type_script_index_0_lang.BOA_LC0h.js" type="module"></script><script src="/_astro/Vimeo.astro_astro_type_script_index_0_lang.CN8EbUvr.js" type="module"></script></head> <body class="bg-white text-stone-950 dark:bg-[#0a0910] dark:text-white" data-astro-cid-37fxchfa> <main class="px-5 sm:mx-auto sm:max-w-2xl sm:px-8 lg:px-0 antialiased md:max-w-6xl grid gap-12 mt-4 overflow-hidden md:overflow-visible" data-astro-cid-37fxchfa> <header class="relative flex items-center h-12 font-semibold"> <a class="text-lg mr-auto" href="/">Home</a> <div id="astro-header-drawer" class="shadow rounded-l-lg md:bg-transparent dark:md:bg-transparent bg-white dark:bg-[#0a0910] md:shadow-none md:rounded-none md:border-none md:h-auto md:static absolute transition-transform duration-300 ease-in translate-x-96 md:translate-x-0 top-12 -right-5 pl-4 pt-6 pb-4 md:p-0 h-[200px] w-[200px] z-50"> <nav class="flex h-full flex-col justify-between gap-12 text-left md:flex-row md:w-full md:gap-5"> <div class="flex flex-col gap-4 md:flex-row md:border-r-2 border-black pr-4 dark:border-white"> <a href="/tags" class="text-opacity-60 flex items-center gap-1 text-2xl md:text-base" rel="noopener noreferrer ">  <svg xmlns="http://www.w3.org/2000/svg" class="w-8 md:w-6" viewBox="0 0 24 24" stroke-width="1.25" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M7.859 6h-2.834a2.025 2.025 0 0 0 -2.025 2.025v2.834c0 .537 .213 1.052 .593 1.432l6.116 6.116a2.025 2.025 0 0 0 2.864 0l2.834 -2.834a2.025 2.025 0 0 0 0 -2.864l-6.117 -6.116a2.025 2.025 0 0 0 -1.431 -.593z"></path> <path d="M17.573 18.407l2.834 -2.834a2.025 2.025 0 0 0 0 -2.864l-7.117 -7.116"></path> <path d="M6 9h-.01"></path> </svg> Tags
 </a> </div> <div class="flex justify-center items-center md:justify-end gap-3 md:p-0"> <a href="https://github.com/danielcgilibert/blog-template" class="text-opacity-60" rel="noopener noreferrer " target="_blank" aria-label="Github">  <span><svg xmlns="http://www.w3.org/2000/svg" class="w-8 md:w-6" viewBox="0 0 24 24" stroke-width="1.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"></path> </svg> </span>  </a><a href="https://github.com/danielcgilibert/blog-template" class="text-opacity-60" rel="noopener noreferrer " target="_blank" aria-label="Twitter">  <span><svg xmlns="http://www.w3.org/2000/svg" class="w-8 md:w-6" viewBox="0 0 24 24" stroke-width="1.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c0 -.249 1.51 -2.772 1.818 -4.013z"></path> </svg> </span>  </a> </div> </nav> </div> <div class="flex items-center gap-3 md:pl-3" data-astro-transition-persist="navbar"> <div> <site-search id="search" class="ms-auto"> <button data-open-modal disabled class="flex items-center justify-center rounded-md gap-1"> <svg aria-label="search" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"> <path stroke="none" d="M0 0h24v24H0z"></path> <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path> </svg> <!-- <span class='md:hidden text-2xl'> Search</span> --> </button> <dialog aria-label="search" class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-white dark:bg-[#0a0910ec] shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md opacity-0"> <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6"> <button data-close-modal class="ms-auto cursor-pointer rounded-full bg-black text-white px-4 py-2 dark:bg-white dark:text-black">Close</button> <div class="search-container dark:text-white"> <div id="pagefind__search"></div> </div> </div> </dialog> </site-search>   </div>  <theme-toggle class="relative h-6 w-6"> <button id="toggle-theme" class="group" aria-label="Toggle Theme"> <span class="absolute left-0 right-0 top-0 opacity-0 group-aria-pressed:opacity-100"> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-sun-high" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M14.828 14.828a4 4 0 1 0 -5.656 -5.656a4 4 0 0 0 5.656 5.656z"></path> <path d="M6.343 17.657l-1.414 1.414"></path> <path d="M6.343 6.343l-1.414 -1.414"></path> <path d="M17.657 6.343l1.414 -1.414"></path> <path d="M17.657 17.657l1.414 1.414"></path> <path d="M4 12h-2"></path> <path d="M12 4v-2"></path> <path d="M20 12h2"></path> <path d="M12 20v2"></path> </svg> </span> <span class="absolute left-0 right-0 top-0 opacity-0 group-aria-[pressed=false]:opacity-100"> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.25" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path> </svg> </span> </button> </theme-toggle> <script>
  const button = document.getElementById("toggle-theme");

  function setButtonPresssed() {
    const bodyThemeIsDark = document.documentElement.classList.contains("dark");
    button.setAttribute("aria-pressed", String(bodyThemeIsDark));
  }
  setButtonPresssed();
</script> <button id="astro-header-drawer-button" type="button" class="md:ml-6 md:hidden"> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.25" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M4 6l16 0"></path> <path d="M4 12l16 0"></path> <path d="M4 18l16 0"></path> </svg> <span class="sr-only">Show Menu</span> </button> </div> </header>   <article class="min-w-full md:py-4 sm:max-w-none md:max-w-none"> <header class="mb-3 flex flex-col justify-center items-center gap-6"> <div class="flex flex-col gap-2"> <div class="flex items-center justify-center gap-x-1"> <p class="text-center text-sm text-opacity-50">
Published <time class="text-sm font-bold text-opacity-60" datetime="2024-05-23T17:00:00.000Z"> May 24, 2024 </time> </p> <p class="text-center text-sm text-opacity-50 font-bold">
- 2 min read </p> </div> <h1 class="text-center text-4xl md:text-6xl md:pb-2.5 font-semibold"> การสร้างผู้ช่วยแจ้งเตือนวันที่หมดสัญญาลูกค้า โดยใช้ Google Apps Script </h1> </div> <div class="flex flex-wrap justify-center items-center gap-2 gap-y-4 md:gap-5"> <a href="/tags/กรุงเทพ" aria-label="กรุงเทพ"> <span class="bg-indigo-600 font-semibold text-white dark:bg-indigo-900 dark:text-white shadow text-sm w-fit px-2 py-1 md:px-5 md:py-2 rounded-full"> กรุงเทพ </span> </a><a href="/tags/แจ้งเตือนวันที่หมดสัญญา" aria-label="แจ้งเตือนวันที่หมดสัญญา"> <span class="bg-indigo-600 font-semibold text-white dark:bg-indigo-900 dark:text-white shadow text-sm w-fit px-2 py-1 md:px-5 md:py-2 rounded-full"> แจ้งเตือนวันที่หมดสัญญา </span> </a><a href="/tags/googlesheet" aria-label="GoogleSheet"> <span class="bg-indigo-600 font-semibold text-white dark:bg-indigo-900 dark:text-white shadow text-sm w-fit px-2 py-1 md:px-5 md:py-2 rounded-full"> GoogleSheet </span> </a><a href="/tags/google apps script" aria-label="Google Apps Script"> <span class="bg-indigo-600 font-semibold text-white dark:bg-indigo-900 dark:text-white shadow text-sm w-fit px-2 py-1 md:px-5 md:py-2 rounded-full"> Google Apps Script </span> </a> </div> </header> <img src="/_astro/Gs_gas.BYGlhtKw_yWHc6.jpg" loading="eager" class="rounded-md w-full max-h-[300px]  md:max-h-[500px] my-8 object-cover" alt="img of การสร้างผู้ช่วยแจ้งเตือนวันที่หมดสัญญาลูกค้า โดยใช้ Google Apps Script" width="1000" height="500" decoding="async"> <hr> <div>  <div class="grid grid-cols-1 md:grid-cols-[20%_auto] gap-10 mt-8"> <!-- aside  --> <aside class="md:flex flex-col gap-8 hidden"> <div class="flex flex-col gap-2"> <span class="mb-1 font-bold text-2xl">Share</span> <ul class="flex gap-3 text-black dark:text-white"> <li> <a href="https://twitter.com/intent/tweet?text=Share this post https://engineering-blog-thaipbs.vercel.app/post/--google-apps-script--googlesheet/" aria-label="Share on Twitter"><!--?xml version="1.0" ?--><svg height="32px" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;" version="1.1" viewBox="0 0 512 512" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path d="M448,512l-384,0c-35.328,0 -64,-28.672 -64,-64l0,-384c0,-35.328 28.672,-64 64,-64l384,0c35.328,0 64,28.672 64,64l0,384c0,35.328 -28.672,64 -64,64Z" id="Dark_Blue" style="fill:#1da1f2;fill-rule:nonzero;"></path><path d="M196.608,386.048c120.704,0 186.752,-100.096 186.752,-186.752c0,-2.816 0,-5.632 -0.128,-8.448c12.8,-9.216 23.936,-20.864 32.768,-34.048c-11.776,5.248 -24.448,8.704 -37.76,10.368c13.568,-8.064 23.936,-20.992 28.928,-36.352c-12.672,7.552 -26.752,12.928 -41.728,15.872c-12.032,-12.8 -29.056,-20.736 -47.872,-20.736c-36.224,0 -65.664,29.44 -65.664,65.664c0,5.12 0.64,10.112 1.664,14.976c-54.528,-2.688 -102.912,-28.928 -135.296,-68.608c-5.632,9.728 -8.832,20.992 -8.832,33.024c0,22.784 11.648,42.88 29.184,54.656c-10.752,-0.384 -20.864,-3.328 -29.696,-8.192l0,0.896c0,31.744 22.656,58.368 52.608,64.384c-5.504,1.536 -11.264,2.304 -17.28,2.304c-4.224,0 -8.32,-0.384 -12.288,-1.152c8.32,26.112 32.64,45.056 61.312,45.568c-22.528,17.664 -50.816,28.16 -81.536,28.16c-5.248,0 -10.496,-0.256 -15.616,-0.896c28.928,18.432 63.488,29.312 100.48,29.312" id="Logo__x2014__FIXED" style="fill:#fff;fill-rule:nonzero;"></path></g></svg></a> </li> <li> <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://engineering-blog-thaipbs.vercel.app/post/--google-apps-script--googlesheet/" aria-label="Share on LinkedIn"> <svg enable-background="new 0 0 32 32" height="32px" id="Layer_1" version="1.0" viewBox="0 0 32 32" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path d="M32,30c0,1.104-0.896,2-2,2H2c-1.104,0-2-0.896-2-2V2c0-1.104,0.896-2,2-2h28c1.104,0,2,0.896,2,2V30z" fill="#007BB5"></path><g><rect fill="#FFFFFF" height="14" width="4" x="7" y="11"></rect><path d="M20.499,11c-2.791,0-3.271,1.018-3.499,2v-2h-4v14h4v-8c0-1.297,0.703-2,2-2c1.266,0,2,0.688,2,2v8h4v-7    C25,14,24.479,11,20.499,11z" fill="#FFFFFF"></path><circle cx="9" cy="8" fill="#FFFFFF" r="2"></circle></g></g><g></g><g></g><g></g><g></g><g></g><g></g></svg></a> </li> <li> <a href="https://www.facebook.com/sharer/sharer.php?u=https://engineering-blog-thaipbs.vercel.app/post/--google-apps-script--googlesheet/" aria-label="Share on facebook"> <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.0" x="0px" y="0px" width="50" height="50" viewBox="0 0 50 50" style="null" class="icon icons8-Facebook-Filled"> <path d="M40,0H10C4.486,0,0,4.486,0,10v30c0,5.514,4.486,10,10,10h30c5.514,0,10-4.486,10-10V10C50,4.486,45.514,0,40,0z M39,17h-3 c-2.145,0-3,0.504-3,2v3h6l-1,6h-5v20h-7V28h-3v-6h3v-3c0-4.677,1.581-8,7-8c2.902,0,6,1,6,1V17z"></path></svg></a> </li> </ul> </div> <div class="sticky top-24 self-start hidden md:block transition-all duration-200"> <nav class="max-w-xs dark:text-black"> <h1 class="font-bold mb-3 text-2xl dark:text-white">Index</h1> <ul class="[text-wrap:balance] flex flex-col gap-1"> <li class="flex flex-col"> <a href="#การสร้างผู้ช่วยแจ้งเตือนวันที่หมดสัญญาลูกค้า-โดยใช้-google-apps-script-และ-googlesheet" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> การสร้างผู้ช่วยแจ้งเตือนวันที่หมดสัญญาลูกค้า โดยใช้ Google Apps Script และ GoogleSheet </a> <ul class="ml-3"> <li class="flex flex-col"> <a href="#บทที่มาและความสำคัญของงานพัฒนาระบบแจ้งเตือนการสิ้นสุดสัญญาจาก-google-spreadsheet-โดยใช้-line-notify-api" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> บทที่มาและความสำคัญของงานพัฒนาระบบแจ้งเตือนการสิ้นสุดสัญญาจาก Google Spreadsheet โดยใช้ LINE Notify API </a>  </li><li class="flex flex-col"> <a href="#ปัญหา" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> **ปัญหา** </a>  </li><li class="flex flex-col"> <a href="#วัตถุประสงค์" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> วัตถุประสงค์ </a>  </li><li class="flex flex-col"> <a href="#ความสำคัญ" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> **ความสำคัญ** </a>  </li><li class="flex flex-col"> <a href="#ผลลัพธ์ที่คาดหวัง" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> **ผลลัพธ์ที่คาดหวัง** </a>  </li><li class="flex flex-col"> <a href="#ข้อจำกัด" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> **ข้อจำกัด** </a>  </li><li class="flex flex-col"> <a href="#แนวทางการพัฒนาต่อไป" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> **แนวทางการพัฒนาต่อไป** </a>  </li><li class="flex flex-col"> <a href="#ความสามารถเด่นๆ-ของ-google-apps-script" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> **ความสามารถเด่นๆ** ของ Google Apps Script: </a>  </li><li class="flex flex-col"> <a href="#ออกแบบโฟลว์การทำงานทั้งหมดของระบบ" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> ออกแบบโฟลว์การทำงานทั้งหมดของระบบ </a>  </li><li class="flex flex-col"> <a href="#ขั้นตอนการเตรียมข้อมูล-และ-สร้าง-app-script-ที่ใช้ในการแจ้งเตือน" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> ขั้นตอนการเตรียมข้อมูล และ สร้าง App Script ที่ใช้ในการแจ้งเตือน </a>  </li><li class="flex flex-col"> <a href="#อธิบายการทำงานของโค้ด" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> อธิบายการทำงานของโค้ด </a>  </li><li class="flex flex-col"> <a href="#ขั้นตอนการตั้งค่าทริกเกอร์เพื่อให้ฟังก์ชั้นทำงานตามช่วงเวลาที่ต้องการแจ้งเตือน" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> ขั้นตอนการตั้งค่าทริกเกอร์เพื่อให้ฟังก์ชั้นทำงานตามช่วงเวลาที่ต้องการแจ้งเตือน </a>  </li><li class="flex flex-col"> <a href="#ผลลัพธ์ของการส่งข้อความแจ้งเตือน" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> ผลลัพธ์ของการส่งข้อความแจ้งเตือน </a>  </li> </ul> </li> </ul> </nav> </div> </aside> <!-- post --> <article class="max-w-full w-full"> <div class="prose prose-lg md:prose-xl dark:prose-invert mb-12 min-w-full"> <h2 id="การสร้างผู้ช่วยแจ้งเตือนวันที่หมดสัญญาลูกค้า-โดยใช้-google-apps-script-และ-googlesheet">การสร้างผู้ช่วยแจ้งเตือนวันที่หมดสัญญาลูกค้า โดยใช้ Google Apps Script และ GoogleSheet</h2>
<p>สถานที่: ส่วนงานพัฒนานวัตกรรม สำนักวิศวกรรม</p>
<p>เจ้าหน้าที่ผู้สร้างสรรค์งาน: เจ้าหน้าที่ส่วนงานพัฒนานวัตกรรม สำนักวิศวกรรม</p>
<p>ผู้บังคับบัญชา/ที่ปรึกษา: นายประเสริฐ นามเวช หัวหน้าส่วนงานพัฒนานวัตกรรม สำนักวิศวกรรม</p>
<p>นางสาว ธัญษรัศม์ ธัญธรรมพันธ์ หัวหน้าส่วนงานวางแผนและบริการ</p>
<p>วันที่สร้างสรรค์งาน: 25 มีนาคม 2567</p>
<p>อ้างอิง​ : <a href="https://developers.google.com/apps-script/samples">https://developers.google.com/apps-script/samples</a></p>
<article class="link-preview" data-astro-cid-hkusvy5r><div class="link-preview__content" data-astro-cid-hkusvy5r><header data-astro-cid-hkusvy5r><a class="link-preview__title" href="https://developers.google.com/apps-script/quickstart/custom-functions" data-astro-cid-hkusvy5r>कस्टम फ़ंक्शन के लिए क्विकस्टार्ट  |  Apps Script  |  Google for Developers</a> <small class="link-preview__domain" data-astro-cid-hkusvy5r>developers.google.com</small></header><small class="link-preview__description" data-astro-cid-hkusvy5r></small></div><img src="https://www.gstatic.com/devrel-devsite/prod/v1d4a4bce9a6f1ad12c0dbb886d406b5bcfdf3882f3026512eb5f609d55157b5b/developers/images/opengraph/white.png" alt="" width="1200" height="630" data-astro-cid-hkusvy5r></article>
<article class="link-preview" data-astro-cid-hkusvy5r><div class="link-preview__content" data-astro-cid-hkusvy5r><header data-astro-cid-hkusvy5r><a class="link-preview__title" href="https://developers.google.com/apps-script/guides/sheets/functions" data-astro-cid-hkusvy5r>Funciones personalizadas en Hojas de cálculo de Google  |  Apps Script  |  Google for Developers</a> <small class="link-preview__domain" data-astro-cid-hkusvy5r>developers.google.com</small></header><small class="link-preview__description" data-astro-cid-hkusvy5r></small></div><img src="https://www.gstatic.com/devrel-devsite/prod/v1d4a4bce9a6f1ad12c0dbb886d406b5bcfdf3882f3026512eb5f609d55157b5b/developers/images/opengraph/white.png" alt="" width="1200" height="630" data-astro-cid-hkusvy5r></article>
<h3 id="บทที่มาและความสำคัญของงานพัฒนาระบบแจ้งเตือนการสิ้นสุดสัญญาจาก-google-spreadsheet-โดยใช้-line-notify-api">บทที่มาและความสำคัญของงานพัฒนาระบบแจ้งเตือนการสิ้นสุดสัญญาจาก Google Spreadsheet โดยใช้ LINE Notify API</h3>
<p>**บทนำ**</p>
<p>ในปัจจุบันองค์กรต่างๆ ล้วนมีธุรกรรมที่เกี่ยวข้องกับสัญญาจำนวนมาก การติดตามและจัดการสัญญาเหล่านี้อย่างมีประสิทธิภาพจึงมีความสำคัญอย่างยิ่งเพื่อป้องกันความเสียหายทางการเงิน และรักษาความสัมพันธ์ที่ดีกับคู่สัญญา อย่างไรก็ตาม การติดตามสัญญาด้วยวิธีดั้งเดิม เช่น การจดบันทึกด้วยตนเอง มักมีความยุ่งยาก ผิดพลาดง่าย และใช้เวลานาน</p>
<h3 id="ปัญหา">**ปัญหา**</h3>
<p>ปัจจุบันยังไม่มีระบบแจ้งเตือนการสิ้นสุดสัญญาที่สะดวก รวดเร็ว และแม่นยำ สำหรับผู้ใช้งานทั่วไป โดยเฉพาะผู้ใช้งานที่ไม่คุ้นเคยกับการเขียนโปรแกรม ระบบที่มีอยู่ส่วนใหญ่ มักเป็นระบบที่ซับซ้อน ใช้งานยาก หรือมีค่าใช้จ่ายสูง</p>
<h3 id="วัตถุประสงค์">วัตถุประสงค์</h3>
<p>งานวิจัยนี้มุ่งหวังพัฒนาระบบแจ้งเตือนการสิ้นสุดสัญญาจาก Google Spreadsheet โดยใช้ LINE Notify API เพื่อช่วยให้องค์กรต่างๆ ติดตามและจัดการสัญญาได้อย่างมีประสิทธิภาพ โดยระบบนี้มีคุณสมบัติ ดังนี้</p>
<p>- **ใช้งานง่าย:** ผู้ใช้งานทั่วไปสามารถใช้งานระบบได้โดยไม่ต้องมีความรู้ด้านการเขียนโปรแกรม</p>
<p>- **รวดเร็ว:** ระบบสามารถแจ้งเตือนการสิ้นสุดสัญญาล่วงหน้าได้ทันเวลา</p>
<p>- **แม่นยำ:** ระบบสามารถดึงข้อมูลจาก Google Spreadsheet โดยตรง จึงลดความเสี่ยงต่อการเกิดข้อผิดพลาด</p>
<p>- **สะดวก:** ผู้ใช้งานสามารถรับการแจ้งเตือนผ่าน LINE Notify ซึ่งเป็นแอปพลิเคชันยอดนิยมที่ใช้งานง่าย</p>
<h3 id="ความสำคัญ">**ความสำคัญ**</h3>
<p>ระบบแจ้งเตือนการสิ้นสุดสัญญามีความสำคัญต่อองค์กรต่างๆ ดังนี้</p>
<p>- **ช่วยป้องกันความเสียหายทางการเงิน:** การแจ้งเตือนล่วงหน้าช่วยให้องค์กรสามารถเตรียมพร้อมสำหรับการต่ออายุสัญญา หรือหาสัญญาใหม่ทดแทน ซึ่งช่วยป้องกันความเสียหายทางการเงินที่อาจเกิดขึ้นจากการสูญเสียโอกาสทางธุรกิจ หรือการถูกเรียกร้องค่าเสียหาย</p>
<p>- **รักษาความสัมพันธ์ที่ดีกับคู่สัญญา:** การแจ้งเตือนล่วงหน้าแสดงให้เห็นถึงความเอาใจใส่ และความรับผิดชอบขององค์กร ซึ่งช่วยสร้างความประทับใจให้กับคู่สัญญา และรักษาความสัมพันธ์ที่ดี</p>
<p>- **เพิ่มประสิทธิภาพการทำงาน:** ระบบแจ้งเตือนช่วยลดภาระงานของพนักงาน โดยไม่ต้องคอยติดตามและตรวจสอบสัญญาด้วยตนเอง ซึ่งช่วยให้พนักงานสามารถทำงานอื่นๆ ได้อย่างมีประสิทธิภาพมากขึ้น</p>
<h3 id="ผลลัพธ์ที่คาดหวัง">**ผลลัพธ์ที่คาดหวัง**</h3>
<p>คาดว่าระบบแจ้งเตือนการสิ้นสุดสัญญาจาก Google Spreadsheet โดยใช้ LINE Notify API จะช่วยให้องค์กรต่างๆ ติดตามและจัดการสัญญาได้อย่างมีประสิทธิภาพ โดยระบบนี้สามารถช่วยป้องกันความเสียหายทางการเงิน รักษาความสัมพันธ์ที่ดีกับคู่สัญญา และเพิ่มประสิทธิภาพการทำงาน</p>
<h3 id="ข้อจำกัด">**ข้อจำกัด**</h3>
<p>ระบบนี้มีข้อจำกัด ดังนี้</p>
<p>- **ระบบจะแจ้งเตือนเฉพาะสัญญาที่มีข้อมูลวันที่สิ้นสุดสัญญาใน Google Spreadsheet เท่านั้น**</p>
<p>- **ผู้ใช้งานต้องมีบัญชี LINE เพื่อรับการแจ้งเตือน**</p>
<h3 id="แนวทางการพัฒนาต่อไป">**แนวทางการพัฒนาต่อไป**</h3>
<p>ในอนาคต มีแผนพัฒนาต่อระบบนี้ ดังนี้</p>
<p>- **พัฒนาระบบให้รองรับการแจ้งเตือนผ่านช่องทางอื่นๆ เพิ่มเติม** เช่น อีเมล หรือ SMS</p>
<p>- **พัฒนาระบบให้รองรับการแจ้งเตือนแบบกำหนดเอง** เช่น แจ้งเตือนล่วงหน้ากี่วัน หรือแจ้งเตือนเฉพาะสัญญาสำคัญ</p>
<p>- **พัฒนาระบบให้รองรับการดึงข้อมูลจากแหล่งข้อมูลอื่นๆ เพิ่มเติม** เช่น ระบบ CRM</p>
<p>- Apps Script เป็นแพลตฟอร์มเดียวที่แทบไม่ต้องใช้การเขียนโค้ดซึ่งใช้สร้างโซลูชันทางธุรกิจที่ใช้งานร่วมกับ Google Workspace รวมทั้งขยายฟังก์ชันการทำงาน และปรับให้เป็นระบบอัตโนมัติได้อย่างง่ายดายและรวดเร็ว เมื่อใช้ Apps Script ผู้ใช้แบบธุรกิจจะสร้างโซลูชันที่กำหนดเองเพิ่มเติมจากการใช้ Google Workspace แบบปกติได้โดยไม่จำเป็นต้องมีทักษะการพัฒนาซอฟต์แวร์มืออาชีพแต่อย่างใด ผู้ใช้ทุกคนที่มีบัญชี Gmail จะใช้ Apps Script ได้</p>
<h3 id="ความสามารถเด่นๆ-ของ-google-apps-script">**ความสามารถเด่นๆ** ของ Google Apps Script:</h3>
<p>- **สร้างระบบอัตโนมัติ:** เขียนสคริปต์เพื่อทำงานที่ซ้ำๆ ภายในแอปของ Google Workspace เช่น Sheets, Docs, Gmail และ Calendar ช่วยให้คุณประหยัดเวลาและแรงงาน</p>
<p>- **ฟังก์ชันกำหนดเอง:** สร้างฟังก์ชันพิเศษเพื่อเพิ่มประสิทธิภาพให้กับ Google Sheets คุณสามารถใช้ฟังก์ชันเหล่านี้ภายในสเปรดชีทได้เหมือนฟังก์ชันสำเร็จรูปทั่วไป</p>
<p>- **ส่วนเสริม:** พัฒนาส่วนเสริม (add-on) เพื่อเพิ่มคุณสมบัติใหม่ๆ ให้กับแอปพลิเคชันใน Google Workspace คุณสามารถใช้ส่วนเสริมเหล่านี้</p>
<h3 id="ออกแบบโฟลว์การทำงานทั้งหมดของระบบ">ออกแบบโฟลว์การทำงานทั้งหมดของระบบ</h3>
<p><img src="https://raw.githubusercontent.com/Jaylaelike/blog-template/main/src/assets/images/Email-and-Line-alertmassagesGoogleScript.png" alt=""/></p>
<p>ระบบนี้ทำงานโดยใช้ Google Sheets เป็นฐานข้อมูล และใช้ Google Apps Script ในการทริกเกอร์เหตุการณ์ตามวันที่และเวลาที่กำหนดไว้ ดังนี้</p>
<p>**1. ดึงข้อมูลจาก Google Sheets**</p>
<p>ระบบจะเริ่มต้นด้วยการดึงข้อมูลจาก Google Sheets ข้อมูลนี้อาจจะเป็นข้อมูลอะไรก็ได้ เช่น รายชื่อลูกค้า รายการนัดหมาย หรือข้อมูลอื่นๆ ที่ต้องการใช้ในระบบ</p>
<p>**2. ทริกเกอร์เหตุการณ์ตามวันที่และเวลา**</p>
<p>ระบบจะใช้ Google Apps Script ในการทริกเกอร์เหตุการณ์ตามวันที่และเวลาที่กำหนดไว้ ตัวอย่างเช่น ระบบอาจจะส่งอีเมลแจ้งเตือนลูกค้า 1 วันก่อนถึงนัดหมาย</p>
<p>**3. ดำเนินการตามขั้นตอนของฟังก์ชัน**</p>
<p>เมื่อเหตุการณ์ถูกทริกเกอร์ ระบบจะดำเนินการตามขั้นตอนของฟังก์ชันที่กำหนดไว้ ขั้นตอนเหล่านี้อาจจะเป็นอะไรก็ได้ เช่น การส่งอีเมล การอัปเดตฐานข้อมูล หรือการสร้างรายงาน</p>
<p>**4. แจ้งเตือนผ่านอีเมลและ Line**</p>
<p>ในขั้นตอนสุดท้าย ระบบอาจจะแจ้งเตือนผู้ใช้ผ่านอีเมลหรือ Line ขึ้นอยู่กับการตั้งค่าของระบบ</p>
<h3 id="ขั้นตอนการเตรียมข้อมูล-และ-สร้าง-app-script-ที่ใช้ในการแจ้งเตือน">ขั้นตอนการเตรียมข้อมูล และ สร้าง App Script ที่ใช้ในการแจ้งเตือน</h3>
<ol>
<li>เตรียมข้อมูลให้ได้ดังรูป ประกอบไปด้วย datetime ต้องมีประเภทข้อมูลเป็น DATETIME()</li>
</ol>
<p><img src="https://raw.githubusercontent.com/Jaylaelike/blog-template/main/src/assets/images/Screenshot-2567-04-25-at-11.12.09.png" alt=""/></p>
<p>2.ไปที่เมนู ส่วนขยาย และไปที่ &gt;&gt; เมนู App Script &gt;&gt; เพื่อนำโค้ดโปรแกรมที่ได้ไป deployed</p>
<p><img src="https://raw.githubusercontent.com/Jaylaelike/blog-template/main/src/assets/images/Screenshot-2567-04-25-at-11.35.13.png" alt=""/></p>
<ol>
<li>เพื่อนำโค้ดโปรแกรมที่ได้ไปวางไว้ที่ รหัส.gs จากนั้นกดปุ่ม บันทึกการทำงาน เป็นอันเสร็จเรียบร้อยในการเตรียม Script ในส่วนของโปรแกรมหลัก</li>
</ol>
<p><img src="https://raw.githubusercontent.com/Jaylaelike/blog-template/main/src/assets/images/Screenshot-2567-04-25-at-11.02.16.png" alt=""/></p>
<h3 id="อธิบายการทำงานของโค้ด">อธิบายการทำงานของโค้ด</h3>
<p>โค้ดนี้ประกอบด้วยฟังก์ชันหลายฟังก์ชันที่ทำงานร่วมกันเพื่อตรวจสอบวันที่ในสเปรดชีทและส่งการแจ้งเตือนทางอีเมลหรือ Line Notify เมื่อพบวันที่ที่ตรงกับวันปัจจุบัน ซึ่งมีรายละเอียดการทำงานดังนี้</p>
<p>1. `checkCountNotify()`</p>
<p>- ฟังก์ชันนี้จะวนลูปผ่านเซลล์ทั้งหมดในสเปรดชีทปัจจุบัน</p>
<p>- ตรวจสอบวันที่ในแต่ละเซลล์โดยนำมาเปรียบเทียบกับวันปัจจุบัน (เวลาถูกตัดทิ้ง)</p>
<p>- นับจำนวนเซลล์ที่มีวันที่ตรงกับวันปัจจุบัน</p>
<p>- แสดงจำนวนวันที่ที่ตรงกับวันปัจจุบันในบันทึกของ Logger</p>
<p>- เรียกฟังก์ชัน `sendCountNotify()` พร้อมส่งจำนวนวันที่ที่ตรงกับวันปัจจุบัน</p>
<p><img src="https://raw.githubusercontent.com/Jaylaelike/blog-template/main/src/assets/images/checkCountNotify.png" alt=""/></p>
<p>2. `sendCountNotify()`</p>
<p>- ฟังก์ชันนี้จะรับพารามิเตอร์ที่เป็นจำนวนวันที่ที่ตรงกับวันปัจจุบัน</p>
<p>- สร้างข้อความแจ้งเตือนโดยใช้จำนวนวันที่ที่ได้รับมา</p>
<p>- ส่งข้อความแจ้งเตือนไปยัง Line Notify ผ่าน API ของ Line Notify</p>
<p><img src="https://raw.githubusercontent.com/Jaylaelike/blog-template/main/src/assets/images/sendCountNotify.png" alt=""/></p>
<p>3. `checkDateTimeAndNotify()`</p>
<p>- เข้าถึงสเปรดชีทที่ใช้งานอยู่</p>
<p>- วนลูปผ่านแถวทั้งหมดในสเปรดชีท</p>
<p>- ตรวจสอบวันที่ในแต่ละแถวโดยนำมาเปรียบเทียบกับวันปัจจุบัน (เวลาถูกตัดทิ้ง)</p>
<p>- สำหรับแถวที่มีวันที่ตรงกับวันปัจจุบัน จะเรียกฟังก์ชัน `getMatchingRowData()` เพื่อรับข้อมูลจากแถวนั้น</p>
<p>- สร้างข้อความแจ้งเตือนจากข้อมูลที่ได้รับมา โดยใช้รูปแบบ HTML</p>
<p>- เพิ่มข้อความแจ้งเตือนลงในรายการ `messageList`</p>
<p>- นับจำนวนข้อความแจ้งเตือนที่เพิ่มลงในรายการ</p>
<p>- หลังจากวนลูปเสร็จสิ้น จะตรวจสอบว่ามีข้อความแจ้งเตือนหรือไม่</p>
<p>- ถ้ามีข้อความแจ้งเตือน จะรวมข้อความทั้งหมดเข้าด้วยกัน โดยแสดงจำนวนสัญญาที่จะสิ้นสุดในวันนี้ด้วย</p>
<p>- เรียกฟังก์ชัน `prepareEmailWithLogos()` เพื่อเตรียมข้อความสำหรับส่งอีเมล โดยมีโลโก้แสดงอยู่ด้วย</p>
<p>- เรียกฟังก์ชัน `sendEmail()` เพื่อส่งอีเมลแจ้งเตือน</p>
<p>- วนลูปผ่านแถวอีกครั้ง เพื่อส่งข้อความแจ้งเตือนไปยัง Line Notify สำหรับแต่ละแถวที่มีวันที่ตรงกับวันปัจจุบัน</p>
<p><img src="https://raw.githubusercontent.com/Jaylaelike/blog-template/main/src/assets/images/checkDateTimeAndNotify.png" alt=""/></p>
<p>4. `getMatchingRowData(rowIndex)`</p>
<p>- ฟังก์ชันนี้จะรับพารามิเตอร์ที่เป็นอินเดกซ์ของแถว</p>
<p>- คืนค่าเป็นอาร์เรย์ที่ประกอบด้วยข้อมูลจากคอลัมน์ B และ C ของแถวนั้น</p>
<p><img src="https://raw.githubusercontent.com/Jaylaelike/blog-template/main/src/assets/images/getMatchingRowData.png" alt=""/></p>
<p>5. `sendLineNotify(message)`</p>
<p>- ฟังก์ชันนี้จะรับพารามิเตอร์ที่เป็นข้อความที่ต้องการส่ง</p>
<p>- ส่งข้อความไปยัง Line Notify ผ่าน API ของ Line Notify</p>
<p><img src="https://raw.githubusercontent.com/Jaylaelike/blog-template/main/src/assets/images/sendLineNotify.png" alt=""/></p>
<p>6. `prepareEmailWithLogos(message)`</p>
<p>- ฟังก์ชันนี้จะรับพารามิเตอร์ที่เป็นข้อความสำหรับอีเมล</p>
<p>- ดึงภาพโลโก้จาก URL และแปลงเป็น Blob</p>
<p>- สร้างข้อความ HTML สำหรับอีเมล โดยมีภาพโลโก้แสดงอยู่ด้วย</p>
<p>- คืนค่าเป็นวัตถุที่มีคีย์ `htmlBody` และ `inlineImages` ซึ่งจะใช้ในการส่งอีเมล</p>
<p><img src="https://raw.githubusercontent.com/Jaylaelike/blog-template/main/src/assets/images/prepareEmailWithLogos.png" alt=""/></p>
<p>7. `sendEmail(emailData)`</p>
<p>- ฟังก์ชันนี้จะรับพารามิเตอร์ที่เป็นวัตถุที่มีคีย์ `htmlBody` และ `inlineImages`</p>
<p>- ส่งอีเมลไปยังที่อยู่อีเมลที่กำหนด โดยใช้ข้อความ HTML และภาพโลโก้ที่ได้รับมา</p>
<p>- สามารถกำหนด email ที่ต้องการส่งหลายๆ account ตรงส่วนของ ``` to: <a href="mailto:examples@gmail.com">examples@gmail.com</a>```</p>
<p><img src="https://raw.githubusercontent.com/Jaylaelike/blog-template/main/src/assets/images/sendEmail.png" alt=""/></p>
<p>โค้ดนี้จะตรวจสอบวันที่ในสเปรดชีทและส่งการแจ้งเตือนทางอีเมลและ Line Notify เมื่อพบวันที่ที่ตรงกับวันปัจจุบัน โดยการแจ้งเตือนทางอีเมลจะมีโลโก้แสดงอยู่ด้วย</p>
<h3 id="ขั้นตอนการตั้งค่าทริกเกอร์เพื่อให้ฟังก์ชั้นทำงานตามช่วงเวลาที่ต้องการแจ้งเตือน">ขั้นตอนการตั้งค่าทริกเกอร์เพื่อให้ฟังก์ชั้นทำงานตามช่วงเวลาที่ต้องการแจ้งเตือน</h3>
<p>1. ไปที่เมนู Trigger ทริกเกอร์ และ เลือกเพิ่มทริกเกอร์ ที่ปุ่มมุมขวาล่าง</p>
<p><img src="https://raw.githubusercontent.com/Jaylaelike/blog-template/main/src/assets/images/Screenshot-2567-04-25-at-11.38.06.png" alt=""/></p>
<p>2. จากนั้นเลือกเมนู ฟังก์ชั่นที่เรียกใช้งานในที่นี่เลือกเป็นฟังก์ชั่นหลักคือ `checkCountNotify()` เสร็จแล้วไปเลือก ประเภทของการทริกเกอร์ ตามเวบาที่ต้องการได้เลยตามรูป จากนั้นกดบันทึก ทริกเกอร์เป็นอันเสร็จเรียบร้อย</p>
<p><img src="https://raw.githubusercontent.com/Jaylaelike/blog-template/main/src/assets/images/Screenshot-2567-04-25-at-11.37.55.png" alt=""/></p>
<h3 id="ผลลัพธ์ของการส่งข้อความแจ้งเตือน">ผลลัพธ์ของการส่งข้อความแจ้งเตือน</h3>
<p><img src="https://raw.githubusercontent.com/Jaylaelike/blog-template/main/src/assets/images/Screenshot-2567-04-25-at-10.18.20.png" alt=""/></p>
<p><img src="https://raw.githubusercontent.com/Jaylaelike/blog-template/main/src/assets/images/Untitled-design-(1)-1.png" alt=""/></p>
<p><img src="https://raw.githubusercontent.com/Jaylaelike/blog-template/main/src/assets/images/Untitled-design-(2).png" alt=""/></p> </div> <!-- related posts --> <footer> <h2 class="font-bold text-lg dark:text-white mb-6">Related Posts</h2> <section class="flex flex-col md:flex-row sm:justify-between gap-8"> <div class="flex flex-wrap gap-2"> <div class="min-h-full"> <img src="/_astro/Screenshot%202567-05-02%20at%2016.48.34.CzJkQU31_2kQPd4.webp" class="w-16 h-16 object-cover rounded-full  " alt="img of ปรับค่าและตั้งค่า Level กำลังส่งฯ" width="200" height="200" loading="lazy" decoding="async"> </div> <header class="flex justify-center items-center"> <a class="font-medium  hover:underline" href="/post/-level-/"> ปรับค่าและตั้งค่า Level กำลังส่งฯ </a> </header> </div><div class="flex flex-wrap gap-2"> <div class="min-h-full"> <img src="/_astro/Screenshot%202567-05-02%20at%2016.51.06.C3GGJ4VX_26y0Qm.webp" class="w-16 h-16 object-cover rounded-full  " alt="img of ตรวจเช็คค่า Parameter และทำ Precorrection #3" width="200" height="200" loading="lazy" decoding="async"> </div> <header class="flex justify-center items-center"> <a class="font-medium  hover:underline" href="/post/-parameter--precorrection-3/"> ตรวจเช็คค่า Parameter และทำ Precorrection #3 </a> </header> </div><div class="flex flex-wrap gap-2"> <div class="min-h-full"> <img src="/_astro/Screenshot%202567-05-02%20at%2016.40.38.DA_es65U_19AI17.webp" class="w-16 h-16 object-cover rounded-full  " alt="img of ตรวจเช็คค่า Parameter ก่อนการทำ Precorrection part #1" width="200" height="200" loading="lazy" decoding="async"> </div> <header class="flex justify-center items-center"> <a class="font-medium  hover:underline" href="/post/-parameter--precorrection-part-1/"> ตรวจเช็คค่า Parameter ก่อนการทำ Precorrection part #1 </a> </header> </div> </section> </footer> </article> </div>  </div> </article>  <footer class="flex justify-center items-center w-full px-16 h-28 border-t-2">
&copy; 2024 Your Name. All rights reserved.
</footer> </main>    </body> </html> 